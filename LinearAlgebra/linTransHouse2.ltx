% Illustrate 2D transform by matrix, AJR Oct 2014 -- Oct 2019
\newcommand{\TwoD}[4]{%
\pgfmathparse{abs(#1)+abs(#2)+abs(#3)+abs(#4)}%
\pgfmathparse{(\pgfmathresult>5)+(\pgfmathresult>3.6)*0.5+0.5}%
\edef\xtdst{\pgfmathresult}%
\begin{tikzpicture}
\begin{axis}[\unithousesize,font=\footnotesize
,height=100pt,xtick distance={\xtdst}
  ,axis lines=middle,thick,axis equal image, enlargelimits=0.05 %,grid,no marks
  ] 
\addplot coordinates {(0,1)(1,1)(1,0)(0,0)(0,1)(0.5,1.2)(1,1)}; 
%\addlegendentry{unit sq.};
\addplot coordinates {(#2,#4)(#1+#2,#3+#4)(#1,#3)(0,0)
  (#2,#4)(#1*0.5+#2*1.2,#3*0.5+#4*1.2)(#1+#2,#3+#4)}; 
%\addlegendentry{transform};
\end{axis}
\end{tikzpicture}
}

% the same, but no coord axes, 
% and extra parameter for extra plot commands
\newcommand{\TwoDx}[5]{%
\begin{tikzpicture}
\begin{axis}[footnotesize,font=\footnotesize
  ,axis lines=none,thick,axis equal 
  ] 
\addplot coordinates {(0,1)(1,1)(1,0)(0,0)(0,1)(0.5,1.2)(1,1)}; 
\addplot coordinates {(#2,#4)(#1+#2,#3+#4)(#1,#3)(0,0)
  (#2,#4)(#1*0.5+#2*1.2,#3*0.5+#4*1.2)(#1+#2,#3+#4)}; 
#5
\end{axis}
\end{tikzpicture}
}%


\newcommand{\TwoDnotLT}[6]{%5th and 6th are the distortion
\begin{tikzpicture}
\pgfmathparse{abs(#1)+abs(#2)+abs(#3)+abs(#4)}%
\pgfmathparse{(\pgfmathresult>5)+(\pgfmathresult>3.6)*0.5+0.5}%
\edef\xtdst{\pgfmathresult}%
\begin{axis}[grid,footnotesize,font=\footnotesize
,xtick distance={\xtdst}
  ,axis lines=middle,thick,axis equal image ] 
\addplot coordinates {(0,1)(1,1)(1,0)(0,0)(0,1)(0.5,1.2)(1,1)}; 
\addplot coordinates {(#2,#4)(#1+#2+#5,#3+#4+#6)(#1,#3)(0,0)
  (#2,#4)(#1*0.5+#5/2+#2*1.2,#3*0.5+#6/2+#4*1.2)(#1+#2+#5,#3+#4+#6)}; 
\end{axis}
\end{tikzpicture}}
